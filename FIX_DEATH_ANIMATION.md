# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ—Ä—Ç–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è

## üéØ –ü—Ä–æ–±–ª–µ–º–∞:
–ü—Ä–∏ —Å–º–µ—Ä—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –Ω–µ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è —Å–º–µ—Ä—Ç–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è.

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã:

### **1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–∑–ª–æ–≤:**
- `PlayerBody` (Node2D) - –æ—Å–Ω–æ–≤–Ω–æ–π —É–∑–µ–ª –∏–≥—Ä–æ–∫–∞
- `Visual` (AnimatedSprite2D) - —É–∑–µ–ª —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
- `character_visual.gd` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏—è–º–∏

### **2. –õ–æ–≥–∏–∫–∞ —Å–º–µ—Ä—Ç–∏:**
1. –í `body.gd` –ø—Ä–∏ `hp <= 0` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `emit_signal("died")`
2. –í `battle_manager.gd` —Å–∏–≥–Ω–∞–ª `died` –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ `_on_player_died()`
3. –í `_on_player_died()` –∏—â–µ—Ç—Å—è —É–∑–µ–ª `Visual` –∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `play_die()`
4. –í `character_visual.gd` –º–µ—Ç–æ–¥ `play_die()` –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–∏–≥—Ä–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é `die`

## üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### **1. –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ `battle_manager.gd`:**
```gdscript
func _on_player_died():
	print("–ò–≥—Ä–æ–∫ –ø–æ–≥–∏–±, –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏...")
	# –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏
	var visual = player_node.get_node_or_null("Visual")
	if visual:
		print("Visual –Ω–∞–π–¥–µ–Ω: ", visual)
		if visual.has_method("play_die"):
			print("–í—ã–∑—ã–≤–∞–µ–º play_die()")
			visual.play_die()
		else:
			print("–û–®–ò–ë–ö–ê: Visual –Ω–µ –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥–∞ play_die()")
	else:
		print("–û–®–ò–ë–ö–ê: Visual –Ω–µ –Ω–∞–π–¥–µ–Ω —É –∏–≥—Ä–æ–∫–∞")
	
	_show_message("–¢—ã –ø–æ–≥–∏–±. –î—É—à–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.")
	emit_signal("battle_ended", false)
```

### **2. –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ `character_visual.gd`:**
```gdscript
func play_die() -> void:
	print("play_die() –≤—ã–∑–≤–∞–Ω –¥–ª—è ", get_parent().name)
	print("die_anim = ", die_anim)
	print("has_animation(die_anim) = ", has_animation(die_anim))
	if has_animation(die_anim):
		print("–ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏: ", die_anim)
		play(die_anim)
	else:
		print("–û–®–ò–ë–ö–ê: –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ—Ä—Ç–∏ '", die_anim, "' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
		print("–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏: ", sprite_frames.get_animation_names() if sprite_frames else "sprite_frames = null")
```

## üéÆ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### **1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
–ü—Ä–∏ —Å–º–µ—Ä—Ç–∏ –∏–≥—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
```
–ò–≥—Ä–æ–∫ –ø–æ–≥–∏–±, –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏...
Visual –Ω–∞–π–¥–µ–Ω: [AnimatedSprite2D:1234]
–í—ã–∑—ã–≤–∞–µ–º play_die()
play_die() –≤—ã–∑–≤–∞–Ω –¥–ª—è PlayerBody
die_anim = die
has_animation(die_anim) = true
–ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏: die
```

### **2. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- **Visual –Ω–µ –Ω–∞–π–¥–µ–Ω** - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —É–∑–ª–æ–≤
- **play_die() –Ω–µ –Ω–∞–π–¥–µ–Ω** - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–∫—Ä–∏–ø—Ç–æ–º
- **–ê–Ω–∏–º–∞—Ü–∏—è die –Ω–µ –Ω–∞–π–¥–µ–Ω–∞** - –ø—Ä–æ–±–ª–µ–º–∞ —Å SpriteFrames
- **sprite_frames = null** - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ä–µ—Å—É—Ä—Å–æ–º

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞:
- ‚úÖ **–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–∑–ª–æ–≤** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ Visual —É–∑–ª–∞
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–æ–≤** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ play_die()
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ die
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ—Ä—Ç–∏! üéÆüíÄ
