# Система кулдаунов активных способностей врагов

## Обзор
Система кулдаунов добавляет стратегическую глубину к боевой системе. Враги больше не могут использовать свои способности каждый ход - после использования способность переходит на перезарядку. Во время перезарядки враг использует базовую атаку.

## Реализованные компоненты

### 1. Body.gd - Отслеживание кулдаунов

Добавлены следующие переменные и методы:

```gdscript
var ability_cooldowns: Dictionary = {} # текущие кулдауны способностей: {ability_id: remaining_turns}

func reduce_ability_cooldowns():
    """Уменьшает кулдауны всех способностей на 1 ход в начале хода персонажа"""

func is_ability_on_cooldown(ability_id: String) -> bool:
    """Проверяет, находится ли способность на кулдауне"""

func set_ability_cooldown(ability_id: String, cooldown: int):
    """Устанавливает кулдаун для способности"""

func get_base_attack_damage() -> int:
    """Возвращает урон базовой атаки в зависимости от типа врага"""
    # Для магов: интеллект + мудрость
    # Для бойцов: сила + ловкость
```

### 2. EnemyAbility.gd - Параметр cooldown

Уже существующий параметр `@export var cooldown: int = 0` используется для определения количества ходов до следующего использования.

### 3. Battle_manager.gd - Логика кулдаунов

#### В начале хода врага:
```gdscript
# Уменьшаем кулдауны всех способностей в начале хода врага
if enemy_node.has_method("reduce_ability_cooldowns"):
    enemy_node.reduce_ability_cooldowns()
```

#### Проверка кулдауна перед использованием:
```gdscript
var ability_on_cooldown = enemy_node.has_method("is_ability_on_cooldown") and enemy_node.is_ability_on_cooldown(enemy_ability.id)

# Враг использует способность, если есть ресурсы и способность НЕ на кулдауне
if enemy_ability.can_use(enemy_node) and not ability_on_cooldown:
    # Используем способность
```

#### Установка кулдауна после использования:
```gdscript
# Устанавливаем кулдаун для способности после использования
if enemy_ability.cooldown > 0 and enemy_node.has_method("set_ability_cooldown"):
    enemy_node.set_ability_cooldown(enemy_ability.id, enemy_ability.cooldown)
```

#### Базовая атака во время кулдауна:
```gdscript
# Если способность не использована, делаем базовую атаку
if not ability_used:
    # Определяем урон базовой атаки (для бойцов: сила + ловкость, для магов: интеллект + мудрость)
    if enemy_node.has_method("get_base_attack_damage"):
        damage = enemy_node.get_base_attack_damage()
    
    # Определяем тип урона базовой атаки (физический для бойцов, магический для магов)
    var is_mage = enemy_node.intelligence >= enemy_node.agility and enemy_node.intelligence >= enemy_node.strength
    damage_type = "magic" if is_mage else "physical"
```

## Базовая атака

### Расчет урона
- **Бойцы** (сила или ловкость >= интеллект): `урон = сила + ловкость`
- **Маги** (интеллект > сила и ловкость): `урон = интеллект + мудрость`

### Тип урона
- **Бойцы**: Физический урон
- **Маги**: Магический урон

### Критический удар
- Базовая атака может критически ударить
- Шанс крита зависит от характеристик врага (как обычно)

## Реализованные способности с кулдаунами

### 1. Крысиный укус (Rat Bite Attack)
- **ID**: `rat_bite_attack`
- **Владелец**: Крыса
- **Кулдаун**: 2 (пропускает 1 ход)
- **Стоимость**: 35 ОВ
- **Формула урона**: `сила + ловкость * 1.5`
- **Дополнительный эффект**: 50% шанс наложить кровотечение
- **Кровотечение**: 5 урона за ход, длится 3 хода

**Важно:** Значение `cooldown` в коде всегда на +1 больше, чем количество пропущенных ходов. Это потому что кулдаун уменьшается в начале каждого хода врага.

#### Особенности реализации:
- Урон рассчитывается динамически от характеристик врага
- Шанс критического удара от базовых характеристик (без бонуса)
- При успешном наложении кровотечения выводится сообщение в лог боя
- Звук: `rat_bite` с громкостью -10.0

### 2. Кислотный взрыв (Acid Blast)
- **ID**: `slime_acid_blast`
- **Владелец**: Слизень
- **Кулдаун**: 4 (пропускает 3 хода)
- **Стоимость**: 30 ОВ
- **Формула урона**: `сила + живучесть`
- **Дополнительный эффект**: Увеличивает `armor_reduction` цели на 5 единиц (постоянно)
- **Особенности**: Эффект складывается с пассивкой "Кислотные удары" и работает только против физического урона

#### Особенности реализации:
- Урон рассчитывается динамически от характеристик врага
- Шанс критического удара от базовых характеристик (без бонуса)
- Использует механику `armor_reduction` (как пассивка "Кислотные удары")
- `armor_reduction` применяется при расчете физического урона: `final_damage = max(0, amount - (defense - armor_reduction))`
- **Может уйти в минус!** Если броня = 60, а armor_reduction = 65, эффективная броня = -5
- Эффект накапливается при повторных использованиях
- Складывается с эффектом пассивки "Кислотные удары"
- При снижении брони выводится сообщение в лог боя с общим значением armor_reduction
- Звук: `sword_hit` с громкостью -5.0

#### Пример работы механики:
```
Начальная броня игрока: 60
armor_reduction: 0

Раунд 1: Слизень использует "Кислотный взрыв"
armor_reduction: 0 → 5
Эффективная броня: 60 - 5 = 55

Раунд 5: Слизень снова использует "Кислотный взрыв"
armor_reduction: 5 → 10
Эффективная броня: 60 - 10 = 50

Между раундами: Слизень использует базовую атаку с пассивкой "Кислотные удары" (разрушает 1 броню)
armor_reduction: 10 → 11
Эффективная броня: 60 - 11 = 49
```

### 3. Пикирование (Bat Swoop)
- **ID**: `bat_swoop`
- **Владелец**: Летучая мышь
- **Кулдаун**: 5 (пропускает 4 хода)
- **Стоимость**: 35 ОВ
- **Формула урона**: `сила + ловкость * 1.5`
- **Бонус крита**: +25%
- **Дополнительный эффект**: 30% шанс оглушить цель на 1 ход
- **Особенности**: Высокий шанс крита делает способность очень опасной

#### Особенности реализации:
- Урон рассчитывается динамически от характеристик врага
- Бонус +25% к шансу крита от базовых характеристик
- Шанс оглушения: 30%
- Оглушение длится 1 ход (цель пропускает свой следующий ход)
- Механика оглушения работает через `add_effect("stun", 1.0, 0, {})`
- Проверка оглушения происходит в начале хода игрока в `_set_player_turn()`
- При оглушении выводится сообщение в лог боя
- Звук: `bat_attack` с громкостью -5.0

#### Пример работы оглушения:
```
Раунд 1: Летучая мышь использует "Пикирование"
Проверка оглушения: 30% → успех!
Игрок получает эффект "stun" на 1 ход

Раунд 2 (ход игрока):
Проверка: has_effect("stun") = true
Сообщение: "Игрок оглушен и пропускает ход!"
Переход к ходу врага без действий игрока

Раунд 3 (ход игрока):
Эффект "stun" исчез (длительность закончилась)
Игрок может действовать
```

### 4. Гнилостный взрыв (Rotten Blast)
- **ID**: `rotten_slime_blast`
- **Владелец**: Гнилой слизень (босс)
- **Кулдаун**: 4 (пропускает 3 хода)
- **Стоимость**: 30 ОВ
- **Формула урона**: `сила + живучесть`
- **Уникальная механика**: Вызывает внеочередное срабатывание гнилостной ауры
- **Особенности**: Наносит двойной удар - физический урон + магический урон от ауры

#### Особенности реализации:
- Урон рассчитывается динамически от характеристик врага
- Шанс критического удара от базовых характеристик (без бонуса)
- При использовании активно ищет пассивку "rotten_aura" у врага
- Если найдена, вызывает `execute_ability()` гнилостной ауры с текущим номером раунда
- Урон от гнилостной ауры: 0.5% от max_hp игрока за раунд, максимум 5% (с 10 раунда)
- Урон от ауры магический (игнорирует физическую защиту)
- Показывает две всплывающие цифры урона: физический + магический
- В лог боя записываются оба урона
- Звук: `sword_hit` с громкостью -5.0
- Если у врага нет пассивки "rotten_aura", выводится предупреждение в консоль

#### Пример работы с гнилостной аурой:
```
Раунд 1: Гнилой слизень использует "Гнилостный взрыв"
Физический урон: сила + живучесть = 30
Гнилостная аура (раунд 1): 0.5% от 300 HP = 1 магический урон
Общий урон: 30 + 1 = 31

Раунд 5: Гнилой слизень снова использует "Гнилостный взрыв"
Физический урон: сила + живучесть = 30
Гнилостная аура (раунд 5): 2.5% от 300 HP = 7 магический урон
Общий урон: 30 + 7 = 37

Раунд 12: Гнилой слизень использует "Гнилостный взрыв"
Физический урон: сила + живучесть = 30
Гнилостная аура (раунд 12): 5% (максимум!) от 300 HP = 15 магический урон
Общий урон: 30 + 15 = 45
```

#### Синергия с пассивкой:
Гнилостная аура срабатывает:
1. В начале хода врага (обычное срабатывание)
2. При использовании "Гнилостного взрыва" (внеочередное срабатывание)

Это делает длительные бои с Гнилым слизнем очень опасными!

### 5. Удар палача (Executioner Strike)
- **ID**: `executioner_strike`
- **Владелец**: Демон Палач (ExecutionerDemon)
- **Кулдаун**: 5 (пропускает 4 хода)
- **Стоимость**: 70 ОВ
- **Формула урона**: `сила + ловкость * 1.5` за каждый удар
- **Бонус крита**: +20% для каждого удара
- **Особенности**: Два разрушительных удара - рубящий и колющий. Очень высокий суммарный урон и повышенный шанс крита, но долгая перезарядка

#### Особенности реализации:
- **Два отдельных удара** с задержкой 0.5 секунды между ними
- Первый удар: **рубящий** (сила + ловкость * 1.5)
- Второй удар: **колющий** (сила + ловкость * 1.5)
- **Каждый удар проверяется на крит отдельно** - можно получить два крита!
- **Каждый удар проверяется на уворот отдельно** - игрок может уклониться от одного удара, но не от другого
- Бонус +20% к шансу крита для каждого удара от базовых характеристик
- Высокая стоимость выносливости (70 ОВ)
- Долгая перезарядка (4 хода) компенсируется очень высоким суммарным уроном
- Синхронизирован с анимацией рубящего и колющего удара
- Звук: `sword_hit` с громкостью -5.0
- Пассивные способности врага срабатывают после каждого удара
- Проверка на дополнительные атаки после каждого удара

#### Пример работы:
```
Демон Палач (уровень 10):
- Сила: 25
- Ловкость: 20
- Базовый шанс крита: 10%

Раунд 1: Демон Палач использует "Удар палача"

Рубящий удар:
Урон: 25 + 20 * 1.5 = 25 + 30 = 55
Шанс крита: 10% + 20% = 30%
Проверка крита: успех! (30% шанс)
Финальный урон: 55 * 1.5 = 82 урона!

[Задержка 0.5 секунды]

Колющий удар:
Урон: 25 + 20 * 1.5 = 25 + 30 = 55
Шанс крита: 10% + 20% = 30%
Проверка крита: промах (70% шанс)
Финальный урон: 55 урона

Общий урон за способность: 82 + 55 = 137 урона!
(если оба удара попали)

Раунд 2-5: Способность на кулдауне
Демон использует базовую атаку: 25 + 20 = 45 урона
(без бонуса к криту, обычный шанс 10%)

Раунд 6: "Удар палача" снова доступен!
```

#### Балансировка:
- **Очень высокий суммарный урон** за счет двух ударов с множителем ловкости (×1.5)
- Высокий шанс крита (30%) для каждого удара - возможен **двойной крит**!
- Каждый удар может быть уклонен отдельно - игрок может избежать части урона
- Дорогая стоимость (70 ОВ) ограничивает частоту использования
- Долгая перезарядка (4 хода) дает игроку время на восстановление
- В среднем за 5 ходов: 1 "Удар палача" (2 удара) + 4 базовые атаки
- Может быть смертельно опасен при двух критах подряд (82 + 82 = 164 урона!)

### 6. Сокрушающий удар (Crushing Strike)
- **ID**: `tharnok_crushing_strike`
- **Владелец**: Демон Тарнок (TharnokDemon)
- **Кулдаун**: 4 (пропускает 3 хода)
- **Стоимость**: 50 ОВ
- **Формула урона**: 
  - Первый удар: `сила + живучесть`
  - Второй удар: `сила + живучесть * 1.7`
- **Шанс отнять ОД**: 30% (только на втором ударе)
- **Особенности**: Два сокрушающих удара с разными формулами урона. Второй удар может отнять 1 очко действий у игрока

#### Особенности реализации:
- **Два отдельных удара** с задержкой 1.0 секунда между ними
- Первый удар: **обычный** (сила + живучесть)
- Второй удар: **усиленный** (сила + живучесть * 1.7) - на 70% больше урона!
- **Каждый удар проверяется на крит отдельно** - можно получить два крита!
- **Каждый удар проверяется на уворот отдельно** - игрок может уклониться от одного удара, но не от другого
- 30% шанс отнять 1 очко действий у игрока **только на втором ударе**
- Средняя стоимость выносливости (50 ОВ)
- Средняя перезарядка (3 хода)
- При успешном отнятии ОД выводится яркое сообщение и запись в лог боя
- Звук: `sword_hit` с громкостью -5.0
- Пассивные способности врага срабатывают после каждого удара
- Проверка на дополнительные атаки после каждого удара

#### Пример работы:
```
Демон Тарнок (уровень 10):
- Сила: 20
- Живучесть: 30
- Базовый шанс крита: 10%

У игрока: 2 ОД (базовое 1 + 1 бонусное от пассивки)

Раунд 1: Демон Тарнок использует "Сокрушающий удар"

Обычный удар:
Урон: 20 + 30 = 50
Шанс крита: 10%
Проверка крита: промах
Финальный урон: 50

[Задержка 1.0 секунда]

Усиленный удар:
Урон: 20 + 30 * 1.7 = 20 + 51 = 71
Шанс крита: 10%
Проверка крита: успех! (10% шанс)
Финальный урон: 71 * 1.5 = 106 урона!

Шанс отнять ОД: 30%
Проверка: успех! (30% шанс)
Сообщение: "ОТНЯТО 1 ОЧКО ДЕЙСТВИЙ В СЛЕДУЮЩЕМ РАУНДЕ!"
Результат: На игрока наложен эффект "action_point_drain"

Общий урон за способность: 50 + 106 = 156 урона!
(если оба удара попали)

Раунд 2: Начало хода игрока
ОД восстанавливаются: 2 → 2
Эффект "action_point_drain" срабатывает: 2 - 1 = 1 ОД
Сообщение: "У ВАС ТОЛЬКО 1 ОЧКО ДЕЙСТВИЙ!"
Результат: Игрок может использовать только 1 способность вместо 2!

Раунд 2-4: Способность на кулдауне
Демон использует базовую атаку: 20 + 15 (ловкость) = 35 урона

Раунд 5: "Сокрушающий удар" снова доступен!
```

#### Механика отнятия ОД:
- Проверяется **только на втором ударе** и только если он попал (30% шанс)
- Накладывает эффект "action_point_drain" на 1 ход
- Эффект срабатывает в **начале следующего хода игрока** (после восстановления ОД)
- Отнимается **ровно 1 ОД** от восстановленного значения
- Не может уйти в отрицательные значения (минимум 0 ОД)
- Если у игрока было 2 ОД, в следующем ходу будет только 1 ОД
- Если у игрока было 1 ОД, в следующем ходу будет 0 ОД (не сможет действовать!)
- Эффект действует только 1 раунд, затем автоматически снимается

#### Балансировка:
- **Высокий суммарный урон** за счет усиленного второго удара (×1.7 к живучести)
- Каждый удар может быть уклонен отдельно - игрок может избежать части урона
- Опасная механика отнятия ОД может сильно замедлить игрока
- 30% шанс - достаточно часто, чтобы быть угрозой, но не гарантированно
- Отнятие ОД только на втором ударе - игрок может избежать его уворотом
- Средняя стоимость (50 ОВ) позволяет использовать чаще, чем "Удар палача"
- Средняя перезарядка (3 хода) создает хороший баланс
- В среднем за 4 хода: 1 "Сокрушающий удар" (2 удара) + 3 базовые атаки
- Особенно опасен против сборок с несколькими ОД
- Может быть смертельно опасен при двух критах подряд (75 + 106 = 181 урона!)

### 7. Двойной удар (Double Strike)
- **ID**: `double_strike`
- **Владелец**: Гоблин Воин
- **Кулдаун**: 3 (пропускает 2 хода)
- **Стоимость**: 30 ОВ
- **Формула урона**: `(сила + ловкость) / 1.5` за каждый удар
- **Особенности**: Наносит 2 удара подряд, каждый проверяется отдельно на уворот и крит

#### Особенности реализации:
- Урон каждого удара рассчитывается динамически: `(сила + ловкость) / 1.5`
- **Каждый удар проверяется на крит отдельно** - можно получить два крита!
- **Каждый удар проверяется на уворот отдельно** - игрок может уклониться от одного удара, но не от другого
- Пассивные способности срабатывают **после каждого удара**
- Между ударами небольшая задержка (0.3 секунды) для визуальной чёткости
- Низкая стоимость выносливости (30 ОВ)
- Короткая перезарядка (2 хода)
- Звук: `sword_hit` с громкостью -5.0

#### Пример работы:
```
Гоблин Воин (уровень 5):
- Сила: 15
- Ловкость: 10
- Базовый шанс крита: 5%

Урон за один удар: (15 + 10) / 1.5 = 16 урона

Раунд 1: Гоблин Воин использует "Двойной удар"

Первый удар:
- Урон: 16
- Проверка крита: неудача (5% шанс)
- Проверка уворота: попадание
- Результат: 16 урона

Второй удар (через 0.3 сек):
- Урон: 16
- Проверка крита: успех! (5% шанс)
- Критический урон: 16 * 1.5 = 24
- Проверка уворота: попадание
- Результат: 24 урона

Общий урон: 16 + 24 = 40 урона!

Раунд 2-3: Способность на кулдауне
Гоблин использует базовую атаку: 15 + 10 = 25 урона

Раунд 4: "Двойной удар" снова доступен!
```

#### Механика двух ударов:
- Оба удара используют одну формулу урона: `(сила + ловкость) / 1.5`
- Проверка на крит независимая для каждого удара
- Проверка на уворот независимая для каждого удара
- Возможные сценарии:
  - Оба удара попали (худший исход для игрока)
  - Первый попал, второй промахнулся
  - Первый промахнулся, второй попал
  - Оба промахнулись (лучший исход для игрока)
- Пассивные способности (например, "Кровавая жажда") срабатывают после каждого удара
- Эффекты уворота (например, контратака) могут сработать на любом ударе

#### Балансировка:
- Низкий урон за удар, но высокий потенциальный урон (два удара)
- Короткая перезарядка (2 хода) делает способность часто доступной
- Низкая стоимость (30 ОВ) позволяет использовать часто
- Каждый удар может критовать = очень высокий потенциал урона при удаче
- Уязвимость к высокому уворот (каждый удар проверяется отдельно)
- Хорошо синергирует с пассивками "на атаку" (срабатывают дважды!)

## Пример работы системы

### Раунд 1:
1. Враг (Крыса) использует "Крысиный укус"
2. Наносится урон: сила + ловкость
3. Проверяется 20% шанс кровотечения
4. Устанавливается кулдаун: 2 хода
5. Сообщение: "Враг использовал Крысиный укус! физический урон: X"
6. DEBUG: `Текущие кулдауны врага: { "rat_bite_attack": 2 }`

### Раунд 2:
1. В начале хода врага уменьшается кулдаун (2 → 1)
2. DEBUG: `Кулдауны врага после уменьшения: { "rat_bite_attack": 1 }`
3. Способность НЕ доступна (кулдаун > 0)
4. Враг использует **базовую атаку** (сила + ловкость)
5. Сообщение: "Способность на перезарядке! Враг нанёс физический урон: X"

### Раунд 3:
1. В начале хода врага уменьшается кулдаун (1 → 0)
2. Кулдаун = 0, удаляется из словаря
3. DEBUG: `Кулдауны врага после уменьшения: {  }`
4. Способность доступна для использования снова!
5. Враг использует "Крысиный укус"

## Важно! Значения кулдаунов в коде

**В коде значение `cooldown` всегда на +1 больше**, чем количество пропущенных ходов врага:

| Описание в документации | Значение cooldown в коде | Как работает |
|------------------------|-------------------------|--------------|
| Перезарядка 1 ход      | `cooldown = 2`         | Используется → 1 ход базовая атака → снова доступна |
| Перезарядка 2 хода     | `cooldown = 3`         | Используется → 2 хода базовая атака → снова доступна |
| Перезарядка 3 хода     | `cooldown = 4`         | Используется → 3 хода базовая атака → снова доступна |

**Почему так?** Потому что кулдаун уменьшается в начале хода врага, до проверки доступности способности.

## Как добавить новую способность с кулдауном

### Шаг 1: Обновить EnemyAbilities.gd
```gdscript
var new_ability = EnemyAbility.new()
new_ability.id = "ability_id"
new_ability.name = "Название способности"
new_ability.description = "Описание способности"
new_ability.cooldown = 4  # Перезарядка 3 хода (cooldown всегда +1)
new_ability.stamina_cost = 30
# ... другие параметры
enemy_abilities["Имя врага"] = new_ability
```

**Помни:** Если в документации написано "перезарядка X ходов", в коде это `cooldown = X + 1`!

### Шаг 2: Добавить логику в EnemyAbility.gd (если нужны дополнительные эффекты)
```gdscript
# Специальная обработка для новой способности
if id == "ability_id":
    # Воспроизводим звук
    if SoundManager:
        SoundManager.play_sound("sound_name", -5.0)
    
    # Рассчитываем урон
    var ability_damage = owner.strength * 2
    
    # Проверяем критический удар
    var ability_crit = randf() < (get_crit_chance(owner) / 100.0)
    
    if ability_crit:
        ability_damage = int(ability_damage * 1.5)
    
    # Проверяем дополнительный эффект (например, оглушение)
    var apply_stun = randf() < 0.30  # 30% шанс
    
    return {
        "success": true,
        "damage": ability_damage,
        "is_crit": ability_crit,
        "damage_type": damage_type,
        "message": owner.display_name + " использует " + name + "!",
        "ability_id": true,  # Флаг для battle_manager
        "apply_stun": apply_stun
    }
```

### Шаг 3: Добавить обработку в battle_manager.gd (если нужны дополнительные эффекты)
```gdscript
elif result.get("ability_id", false):
    # Специальная обработка для новой способности
    player_node.take_damage(damage, damage_type)
    
    # Показываем всплывающую цифру урона
    DamageNumberManager.show_damage_on_character(player_node, damage, is_crit, false, false, damage_type)
    
    # Проверяем наложение дополнительного эффекта
    if result.get("apply_stun", false):
        player_node.add_effect("stun", 1.0, 0, {})
        battle_log.log_event("stun_applied", enemy_node.display_name, player_node.display_name, 0, "Игрок оглушен!")
    
    # Активируем пассивные способности врага при атаке
    var context_attack = {"damage": damage, "target": player_node, "ability_used": true, "is_critical": is_crit, "damage_type": damage_type}
    enemy_node.trigger_passive_abilities(PassiveAbilityClass.TriggerType.ON_ATTACK, player_node, context_attack)
```

### Шаг 4: Обновить документацию
Добавить способность в `ALL_ENEMY_ACTIVE_ABILITIES.md` с пометкой `[РЕАЛИЗОВАНО]`.

## Балансировка

### Рекомендации по кулдаунам (в документации):
- **Слабые способности**: 1-2 хода перезарядки (`cooldown = 2-3` в коде)
- **Средние способности**: 2-3 хода перезарядки (`cooldown = 3-4` в коде)
- **Сильные способности**: 3-4 хода перезарядки (`cooldown = 4-5` в коде)
- **Ультимативные способности**: 5+ ходов перезарядки (`cooldown = 6+` в коде)

### Соотношение урон/кулдаун:
- Чем выше кулдаун, тем мощнее должна быть способность
- Учитывайте урон базовой атаки при балансировке
- Дополнительные эффекты (кровотечение, оглушение и т.д.) должны компенсировать длительный кулдаун

## Тестирование

### Что проверить:
1. ✅ Способность используется на 1-м ходу
2. ✅ Кулдаун устанавливается правильно
3. ✅ В следующем ходу способность на кулдауне
4. ✅ Враг использует базовую атаку во время кулдауна
5. ✅ Сообщение о кулдауне отображается корректно
6. ✅ Кулдаун уменьшается в начале каждого хода
7. ✅ После окончания кулдауна способность снова доступна
8. ✅ Дополнительные эффекты работают корректно

---

**Автор**: AI Assistant  
**Дата**: 2024  
**Версия**: 1.0  
**Статус**: Активная разработка - реализована первая способность (Крысиный укус)

