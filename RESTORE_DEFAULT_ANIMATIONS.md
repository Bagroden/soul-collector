# –í–æ–∑–≤—Ä–∞—Ç –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é –∞–Ω–∏–º–∞—Ü–∏–π

## üéØ –ü—Ä–æ–±–ª–µ–º–∞:
–ü–æ–ø—ã—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏ –∏–≥—Ä–æ–∫–∞ —Å–ª–æ–º–∞–ª–∏ –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏ –≤—Ä–∞–≥–æ–≤ - –æ–Ω–∏ –∑–∞—Å—Ç—ã–≤–∞—é—Ç –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º –∫–∞–¥—Ä–µ.

## üßπ –ß—Ç–æ —É–±—Ä–∞–Ω–æ:

### **1. –ò–∑ `character_visual.gd`:**
- ‚úÖ **–£–±—Ä–∞–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏** - `animation = die_anim`
- ‚úÖ **–£–±—Ä–∞–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∏–≥–Ω–∞–ª—É** - `animation_finished.connect()`
- ‚úÖ **–£–±—Ä–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_on_die_animation_finished()`** - –≤—Å—è —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ **–£–±—Ä–∞–Ω–æ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ** - `sprite_frames.set_animation_loop()`
- ‚úÖ **–£–±—Ä–∞–Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∫–∞–¥—Ä–µ** - `stop()`

### **2. –ò–∑ `battle_manager.gd`:**
- ‚úÖ **–£–±—Ä–∞–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞** - `await get_tree().create_timer(0.1).timeout`
- ‚úÖ **–£–±—Ä–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_set_battle_state()`** - –≤—Å—è —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ **–£–±—Ä–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** - `if player_node.hp <= 0`

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:

### **–ë—ã–ª–æ (—Å–ª–æ–∂–Ω–æ –∏ —Å–ª–æ–º–∞–Ω–Ω–æ):**
```gdscript
func play_die() -> void:
	if has_animation(die_anim):
		# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
		animation = die_anim
		play(die_anim)
		# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–∏–≥–Ω–∞–ª—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∫–∞–¥—Ä–µ
		animation_finished.connect(_on_die_animation_finished, CONNECT_ONE_SHOT)

func _on_die_animation_finished():
	# –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ idle - –ø–µ—Ä—Å–æ–Ω–∞–∂ –º–µ—Ä—Ç–≤!
	
	# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–∞–¥—Ä –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–º–µ—Ä—Ç–∏ –∫–∞–∫ —Ç–µ–∫—É—â–∏–π
	if sprite_frames and sprite_frames.has_animation(die_anim):
		var last_frame = sprite_frames.get_frame_count(die_anim) - 1
		frame = last_frame
		# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–º–µ—Ä—Ç–∏ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–∞–¥—Ä
		animation = die_anim
		
		# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∫–∞–∫ –∑–∞—Ü–∏–∫–ª–µ–Ω–Ω—É—é, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–ª–∞—Å—å
		sprite_frames.set_animation_loop(die_anim, true)
		
		# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∫–∞–¥—Ä–µ
		stop()
```

### **–°—Ç–∞–ª–æ (–ø—Ä–æ—Å—Ç–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç):**
```gdscript
func play_die() -> void:
	if has_animation(die_anim):
		play(die_anim)
```

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞:
- ‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ Godot** - –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ—Ä—Ç–∏ –≤—Ä–∞–≥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –Ω–µ –∑–∞—Å—Ç—ã–≤–∞–µ—Ç –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º –∫–∞–¥—Ä–µ
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ—Ä—Ç–∏ –∏–≥—Ä–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ
- ‚úÖ **–ù–µ—Ç —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏** - –ø—Ä–æ—Å—Ç–æ–π –≤—ã–∑–æ–≤ `play(die_anim)`

**–ê–Ω–∏–º–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é Godot!** üéÆ‚ú®
