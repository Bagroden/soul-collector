# Система визуального оформления комнат

## 📋 Обзор

Каждый тип комнаты и редкость врага имеют уникальное визуальное оформление с цветовым кодированием, иконками и эффектами свечения.

---

## 🎨 Типы комнат и их стили

### 1. 📜 КВЕСТОВАЯ КОМНАТА (Высший приоритет)

**Внешний вид:**
```
┌──────────────────────────────────┐
│  ЗОЛОТАЯ РАМКА (3px)            │
│  Темно-золотистый фон           │
│  Пульсирующее свечение          │
│                                  │
│  ⭐ Логово вора ⭐               │
│  📜 КВЕСТОВАЯ КОМНАТА 📜         │
│  Старое убежище, где...         │
│  [⚔️ Войти]                     │
└──────────────────────────────────┘
```

**Цветовая схема:**
- Фон: `Color(0.15, 0.1, 0.05, 0.95)` - темно-золотистый
- Рамка: `Color(1.0, 0.8, 0.2, 1.0)` - золотая, 3px
- Название: `Color(1.0, 0.9, 0.3, 1)` - яркое золото
- Иконка: ⭐
- Тень: Да, золотистая
- Свечение: Да, золотое пульсирование

---

### 2. 👑 БОСС ЛОКАЦИИ

**Внешний вид:**
```
┌──────────────────────────────────┐
│  ЧЕРНАЯ РАМКА (3px)             │
│  Почти черный фон               │
│  Пульсирующее белое свечение    │
│                                  │
│  👑 Логово босса 👑              │
│  👑 БОСС ЛОКАЦИИ 👑              │
│  Здесь обитает могущественный...│
│  [⚔️ К БОССУ]                   │
└──────────────────────────────────┘
```

**Цветовая схема:**
- Фон: `Color(0.05, 0.05, 0.05, 0.95)` - почти черный
- Рамка: `Color(0.3, 0.3, 0.3, 1.0)` - темно-серая, 3px
- Название: `Color(0.9, 0.9, 0.9, 1)` - почти белый
- Иконка: 👑
- Метка: "👑 БОСС ЛОКАЦИИ 👑"
- Тень: Да, черная
- Свечение: Да, белое пульсирование

---

### 3. 💀 ЭЛИТНЫЙ ВРАГ

**Внешний вид:**
```
┌──────────────────────────────────┐
│  ЗОЛОТАЯ РАМКА (3px)            │
│  Темно-золотистый фон           │
│  Пульсирующее золотое свечение  │
│                                  │
│  💀 Элитная комната 💀           │
│  💀 ЭЛИТНЫЙ ВРАГ 💀              │
│  Здесь обитает Элитный враг!    │
│  [⚔️ Сражаться]                 │
└──────────────────────────────────┘
```

**Цветовая схема:**
- Фон: `Color(0.15, 0.12, 0.05, 0.95)` - темно-золотистый
- Рамка: `Color(1.0, 0.85, 0.3, 1.0)` - золотая, 3px
- Название: `Color(1.0, 0.9, 0.4, 1)` - яркий золотой
- Иконка: 💀
- Метка: "💀 ЭЛИТНЫЙ ВРАГ 💀"
- Тень: Да, золотистая
- Свечение: Да, золотое пульсирование

---

### 4. 🌿 КОМНАТА ОТДЫХА

**Внешний вид:**
```
┌──────────────────────────────────┐
│  ЗЕЛЕНАЯ РАМКА (2px)            │
│  Темно-зеленый фон              │
│  Мягкое зеленое свечение        │
│                                  │
│  🌿 Тихая поляна 🌿              │
│  🌿 БЕЗОПАСНОЕ МЕСТО 🌿          │
│  Безопасное место для отдыха... │
│  [🛡️ Отдохнуть]                 │
└──────────────────────────────────┘
```

**Цветовая схема:**
- Фон: `Color(0.05, 0.15, 0.1, 0.9)` - темно-зеленый
- Рамка: `Color(0.3, 0.8, 0.5, 1.0)` - зеленая, 2px
- Название: `Color(0.5, 1.0, 0.7, 1)` - светло-зеленый
- Иконка: 🌿
- Метка: "🌿 БЕЗОПАСНОЕ МЕСТО 🌿"
- Тень: Нет
- Свечение: Да, зеленое пульсирование

---

## ⚔️ Редкости врагов (обычные бои)

### Common (Обычный) - Серый

```
┌──────────────────────────────────┐
│  СЕРАЯ РАМКА (2px)              │
│  ⚔️ [Название врага] ⚔️          │
│  Обычный враг                    │
│  [Выбрать]                       │
└──────────────────────────────────┘
```

- Фон: `Color(0.12, 0.12, 0.12, 0.9)`
- Рамка: `Color(0.6, 0.6, 0.6, 1.0)` - серая
- Название: `Color(0.8, 0.8, 0.8, 1)` - серый
- Свечение: Нет

---

### Uncommon (Необычный) - Зеленый

```
┌──────────────────────────────────┐
│  ЗЕЛЕНАЯ РАМКА (2px)            │
│  ⚔️ [Название врага] ⚔️          │
│  🟢 Необычный враг               │
│  [Выбрать]                       │
└──────────────────────────────────┘
```

- Фон: `Color(0.05, 0.15, 0.05, 0.9)` - темно-зеленый
- Рамка: `Color(0.4, 0.9, 0.4, 1.0)` - зеленая
- Название: `Color(0.5, 1.0, 0.5, 1)` - светло-зеленый
- Свечение: Нет

---

### Rare (Редкий) - Синий

```
┌──────────────────────────────────┐
│  СИНЯЯ РАМКА (2px)              │
│  Легкое голубое свечение        │
│  ⚔️ [Название врага] ⚔️          │
│  🔵 Редкий враг                  │
│  [Выбрать]                       │
└──────────────────────────────────┘
```

- Фон: `Color(0.05, 0.1, 0.2, 0.95)` - темно-синий
- Рамка: `Color(0.3, 0.6, 1.0, 1.0)` - синяя
- Название: `Color(0.4, 0.7, 1.0, 1)` - светло-синий
- Свечение: Да, голубое

---

### Epic (Эпический) - Фиолетовый

```
┌──────────────────────────────────┐
│  ФИОЛЕТОВАЯ РАМКА (3px)         │
│  Пульсирующее фиолетовое свеч.  │
│  ⚔️ [Название врага] ⚔️          │
│  🟣 Эпический враг               │
│  [Выбрать]                       │
└──────────────────────────────────┘
```

- Фон: `Color(0.15, 0.05, 0.2, 0.95)` - темно-фиолетовый
- Рамка: `Color(0.7, 0.3, 1.0, 1.0)` - фиолетовая, 3px
- Название: `Color(0.8, 0.4, 1.0, 1)` - яркий фиолетовый
- Шрифт: 17px (увеличен)
- Свечение: Да, фиолетовое

---

### Legendary (Легендарный) - Оранжевый

```
┌──────────────────────────────────┐
│  ОРАНЖЕВАЯ РАМКА (3px)          │
│  Пульсирующее золотое свечение  │
│  ⚔️ [Название врага] ⚔️          │
│  🟠 Легендарный враг             │
│  [Выбрать]                       │
└──────────────────────────────────┘
```

- Фон: `Color(0.2, 0.1, 0.0, 0.95)` - темно-оранжевый
- Рамка: `Color(1.0, 0.6, 0.2, 1.0)` - оранжевая, 3px
- Название: `Color(1.0, 0.7, 0.3, 1)` - яркий оранжевый
- Шрифт: 18px (увеличен)
- Кнопка: 15px (увеличена)
- Тень: Да, оранжево-черная
- Свечение: Да, золотое

---

### Mythic (Мифический) - Красный

```
┌──────────────────────────────────┐
│  КРАСНАЯ РАМКА (3px)            │
│  Пульсирующее красное свечение  │
│  ✨ [Название врага] ✨          │
│  ✨ Мифический враг ✨           │
│  [⚔️ ВЫЗОВ]                     │
└──────────────────────────────────┘
```

- Фон: `Color(0.2, 0.05, 0.05, 0.95)` - темно-красный
- Рамка: `Color(1.0, 0.2, 0.2, 1.0)` - ярко-красная, 3px
- Название: `Color(1.0, 0.3, 0.3, 1)` - ярко-красный
- Иконка: ✨ (вместо ⚔️)
- Шрифт: 19px (увеличен)
- Кнопка: "⚔️ ВЫЗОВ", 16px (увеличена)
- Тень: Да, красно-черная
- Свечение: Да, красное

---

## 📊 Таблица цветов

| Тип/Редкость | Цвет рамки | Цвет названия | Ширина рамки | Свечение |
|--------------|------------|---------------|--------------|----------|
| **Квест** | 🟡 Золотой | 🟡 Золотой | 3px | ✅ Да |
| **Босс** | ⚫ Черный | ⚪ Белый | 3px | ✅ Да (белое) |
| **Элитный** | 🟡 Золотой | 🟡 Золотой | 3px | ✅ Да |
| **Отдых** | 🟢 Зеленый | 🟢 Зеленый | 2px | ✅ Да |
| Common | ⚪ Серый | ⚪ Серый | 2px | ❌ Нет |
| Uncommon | 🟢 Зеленый | 🟢 Зеленый | 2px | ❌ Нет |
| Rare | 🔵 Синий | 🔵 Синий | 2px | ✅ Да |
| Epic | 🟣 Фиолетовый | 🟣 Фиолетовый | 3px | ✅ Да |
| Legendary | 🟠 Оранжевый | 🟠 Оранжевый | 3px | ✅ Да |
| Mythic | 🔴 Красный | 🔴 Красный | 3px | ✅ Да |

---

## 🎯 Приоритеты оформления

```
1. КВЕСТ (высший приоритет)
   └─> Золотой, независимо от типа врага

2. ТИП КОМНАТЫ
   ├─> Босс → Черный (белый текст)
   ├─> Элитный → Золотой
   └─> Отдых → Зеленый

3. РЕДКОСТЬ ВРАГА (обычные бои)
   ├─> Mythic → Красный
   ├─> Legendary → Оранжевый
   ├─> Epic → Фиолетовый
   ├─> Rare → Синий
   ├─> Uncommon → Зеленый
   └─> Common → Серый
```

---

## 🔧 Реализация

### Функция `_get_room_style()`

**Параметры:**
- `room_type: RoomData.RoomType` - тип комнаты
- `enemy_rarity: String` - редкость врага
- `is_quest: bool` - квестовая ли комната

**Возвращает словарь со стилем:**

```gdscript
{
    "bg_color": Color,           # Цвет фона
    "border_color": Color,       # Цвет рамки
    "border_width": int,         # Ширина рамки (2-3px)
    "direction_color": Color,    # Цвет текста направления
    "name_color": Color,         # Цвет названия комнаты
    "desc_color": Color,         # Цвет описания
    "type_label": String,        # Метка типа ("БОСС", "ЭЛИТНЫЙ" и т.д.)
    "type_label_color": Color,   # Цвет метки типа
    "icon": String,              # Иконка (emoji)
    "font_size": int,            # Размер шрифта названия (16-20px)
    "button_text": String,       # Текст кнопки
    "button_font_size": int,     # Размер шрифта кнопки (14-16px)
    "button_color": Color,       # Цвет кнопки
    "has_glow": bool,           # Есть ли эффект свечения
    "glow_color": Color,        # Цвет свечения
    "has_shadow": bool,         # Есть ли тень у текста
    "shadow_color": Color       # Цвет тени
}
```

---

### Функция `_add_room_glow_effect()`

**Параметры:**
- `panel: Panel` - панель комнаты
- `glow_color: Color` - цвет свечения

**Эффект:**
Создает бесконечную `Tween` анимацию пульсации:
1. Яркость увеличивается до `glow_color` (1 секунда)
2. Яркость уменьшается до нормальной (1 секунда)
3. Повтор бесконечно

---

## 🎮 Игровой опыт

### Пример выбора комнат:

```
Этап 5: Выбор комнаты

┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐
│ ← НАЛЕВО            │  │ ↑ ПРЯМО             │  │ → НАПРАВО           │
│ [СЕРАЯ РАМКА]       │  │ [СИНЯЯ РАМКА]       │  │ [ЗОЛОТАЯ РАМКА]     │
│                     │  │ (голубое свечение)  │  │ (золотое свечение)  │
│ ⚔️ Темный зал ⚔️    │  │ ⚔️ Логово зверя ⚔️  │  │ ⭐ Логово вора ⭐   │
│ Обычный враг        │  │ 🔵 Редкий враг      │  │ 📜 КВЕСТОВАЯ 📜     │
│                     │  │                     │  │                     │
│ [Выбрать]           │  │ [Выбрать]           │  │ [⚔️ Войти]          │
└─────────────────────┘  └─────────────────────┘  └─────────────────────┘
```

**Игрок видит:**
- Слева: обычная комната (серая) - безопасный вариант
- По центру: редкий враг (синяя, светится) - средний вызов
- Справа: **КВЕСТ** (золотая, ярко светится) - важно!

**Визуальная иерархия:**
- ⚫ **Черный** = Босс (максимальная угроза)
- 🔴 **Красный** = Мифический (критическая опасность)
- 🟡 **Золотой** = Квест / Элитный (важно и опасно)
- 🟠 **Оранжевый** = Легендарный (очень опасно)
- 🟣 **Фиолетовый** = Эпический (опасно)
- 🔵 **Синий** = Редкий (интересно)
- 🟢 **Зеленый** = Отдых / Необычный (спокойно)
- ⚪ **Серый** = Обычный (стандарт)

---

## 📝 Особенности

### Размеры шрифтов:

| Важность | Название | Кнопка |
|----------|----------|--------|
| Обычная | 16px | 14px |
| Редкая | 16-17px | 14px |
| Эпик+ | 17-18px | 15px |
| Мифик | 19px | 16px |
| Босс/Элит | 18-20px | 15-16px |
| Квест | **20px** | **16px** |

### Ширина рамки:

- **2px**: Common, Uncommon, Rare, Rest
- **3px**: Epic, Legendary, Mythic, Boss, Elite, Quest

### Тени текста:

**Есть у:**
- Квест (золотая)
- Босс (красно-черная)
- Элитный (фиолетово-черная)
- Legendary (оранжево-черная)
- Mythic (розово-черная)

**Нет у:**
- Common, Uncommon, Rare, Epic
- Отдых

---

## 🐛 Отладка

### Проверка стилей:

```gdscript
print("Тип комнаты:", room.room_type)
print("Редкость:", room.enemy_rarity)
print("Квест:", room.is_quest_room)
print("Стиль:", _get_room_style(room.room_type, room.enemy_rarity, room.is_quest_room))
```

### Тестирование в игре:

1. Войдите в локацию
2. Проверьте 3 варианта комнат
3. Убедитесь что:
   - ✅ Цвета соответствуют редкости
   - ✅ Свечение работает
   - ✅ Иконки правильные
   - ✅ Квестовая комната ярче всех

---

## 📚 Расширение

### Добавление новой редкости:

```gdscript
"new_rarity":
    style.bg_color = Color(...)
    style.border_color = Color(...)
    style.border_width = 2 or 3
    style.name_color = Color(...)
    style.type_label = "🎯 Новая редкость"
    style.type_label_color = Color(...)
    style.icon = "🎯"
    style.has_glow = true/false
    style.glow_color = Color(...)
```

### Добавление нового типа комнаты:

```gdscript
if room_type == RoomData.RoomType.NEW_TYPE:
    style.bg_color = Color(...)
    style.border_color = Color(...)
    # ... остальные параметры
    return style
```

---

**Дата создания:** 20 ноября 2025  
**Версия:** 1.0  
**Статус:** ✅ Реализовано  
**Файл:** `Scripts/RoomSelector.gd`

