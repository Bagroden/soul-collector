# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–æ–π–Ω–æ–≥–æ —É—Ä–æ–Ω–∞ –æ—Ç –ö—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞

–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å "–ö—Ä—ã—Å–∏–Ω—ã–π —É–∫—É—Å" –Ω–∞–Ω–æ—Å–∏–ª–∞ —É—Ä–æ–Ω **–¥–≤–∞–∂–¥—ã**!

### –ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–∞:
```
Player –ø–æ–ª—É—á–∏–ª 24 —É—Ä–æ–Ω–∞ –∑–∞ —Ä–∞—É–Ω–¥ (–≤—Å–µ–≥–æ: 24)
–ö—Ä—ã—Å–∞ (—É—Ä. 2) –Ω–∞–Ω–æ—Å–∏—Ç 24 —É—Ä–æ–Ω–∞ Player (—É—Ä. 1). –û–ó Player: 68 (92 - 24)

Player –ø–æ–ª—É—á–∏–ª 24 —É—Ä–æ–Ω–∞ –∑–∞ —Ä–∞—É–Ω–¥ (–≤—Å–µ–≥–æ: 48)  ‚Üê –í–¢–û–†–û–ô –†–ê–ó!
–ö—Ä—ã—Å–∞ (—É—Ä. 2) –Ω–∞–Ω–æ—Å–∏—Ç 24 —É—Ä–æ–Ω–∞ Player (—É—Ä. 1). –û–ó Player: 44 (68 - 24)
```

–£—Ä–æ–Ω –Ω–∞–Ω–æ—Å–∏–ª—Å—è **–¥–≤–∞–∂–¥—ã**: 24 + 24 = **48 —É—Ä–æ–Ω–∞** –≤–º–µ—Å—Ç–æ 24!

---

## üîç –ü—Ä–∏—á–∏–Ω–∞ –±–∞–≥–∞

**–§–∞–π–ª:** `Scripts/Battle/battle_manager.gd`

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞:

```gdscript
elif result.get("rat_bite", false):
    # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è "–ö—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞"
    player_node.take_damage(damage, damage_type)  # ‚Üê –ü–ï–†–í–´–ô –í–´–ó–û–í (—Å—Ç—Ä–æ–∫–∞ 883)
    ...

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è (–û–¢–î–ï–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê, –ù–ï –í –ë–õ–û–ö–ï elif!)
if result.get("apply_bleeding", false):  # ‚Üê —Å—Ç—Ä–æ–∫–∞ 888
    ...
    # –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–∞—Å—Å–∏–≤–æ–∫ –±—ã–ª–∞ –∑–¥–µ—Å—å

elif result.get("bat_swoop", false):
    ...
...
else:  # ‚Üê —Å—Ç—Ä–æ–∫–∞ 1060
    # –û–±—ã—á–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–Ω–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è)
    player_node.take_damage(damage, damage_type)  # ‚Üê –í–¢–û–†–û–ô –í–´–ó–û–í (—Å—Ç—Ä–æ–∫–∞ 1062)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** 

–ü—Ä–æ–≤–µ—Ä–∫–∞ `if result.get("apply_bleeding", false):` –Ω–∞—Ö–æ–¥–∏–ª–∞—Å—å **–í–ù–ï** –±–ª–æ–∫–∞ `elif result.get("rat_bite", false)`. 

–ò–∑-–∑–∞ —ç—Ç–æ–≥–æ:
1. ‚úÖ –í—ã–ø–æ–ª–Ω—è–ª—Å—è –±–ª–æ–∫ `elif result.get("rat_bite", false):` ‚Üí —É—Ä–æ–Ω –Ω–∞–Ω–µ—Å–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 883)
2. ‚úÖ –í—ã–ø–æ–ª–Ω—è–ª—Å—è –±–ª–æ–∫ `if result.get("apply_bleeding", false):` ‚Üí –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –Ω–∞–ª–æ–∂–µ–Ω–æ
3. ‚ùå **–ö–æ–¥ –ø–∞–¥–∞–ª –≤ `else` (—Å—Ç—Ä–æ–∫–∞ 1060)** ‚Üí —É—Ä–æ–Ω –Ω–∞–Ω–µ—Å–µ–Ω **–ï–©–ï –†–ê–ó** (—Å—Ç—Ä–æ–∫–∞ 1062)!

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ `if result.get("apply_bleeding")` –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Ü–µ–ø–æ—á–∫–∏ `elif`, –∏ –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–ª –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∞–ª—å—à–µ –¥–æ –±–ª–æ–∫–∞ `else`.

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–§–∞–π–ª:** `Scripts/Battle/battle_manager.gd` (—Å—Ç—Ä–æ–∫–∏ 881-896)

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```gdscript
elif result.get("rat_bite", false):
    # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è "–ö—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞"
    player_node.take_damage(damage, damage_type)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â—É—é —Ü–∏—Ñ—Ä—É —É—Ä–æ–Ω–∞
    DamageNumberManager.show_damage_on_character(player_node, damage, is_crit, false, false, damage_type)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è (–í–ù–£–¢–†–ò –ë–õ–û–ö–ê rat_bite)
    if result.get("apply_bleeding", false):
        # –ù–∞–∫–ª–∞–¥—ã–≤–∞–µ–º –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –Ω–∞ 3 —Ö–æ–¥–∞, 5 —É—Ä–æ–Ω–∞ –∑–∞ —Ö–æ–¥ (1 —Å—Ç–∞–∫)
        player_node.add_effect("bleeding", 3.0, 1, {"damage_per_turn": 5})
        battle_log.log_event("bleeding_applied", enemy_node.display_name, player_node.display_name, 5, "–ò–≥—Ä–æ–∫ –Ω–∞—á–∏–Ω–∞–µ—Ç –∫—Ä–æ–≤–æ—Ç–æ—á–∏—Ç—å! 5 —É—Ä–æ–Ω–∞ –∑–∞ —Ö–æ–¥")
    
    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–∞—Å—Å–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—Ä–∞–≥–∞ –ø—Ä–∏ –∞—Ç–∞–∫–µ (–í–ù–£–¢–†–ò –ë–õ–û–ö–ê rat_bite)
    var context_attack = {"damage": damage, "target": player_node, "ability_used": true, "is_critical": is_crit, "damage_type": damage_type}
    enemy_node.trigger_passive_abilities(PassiveAbilityClass.TriggerType.ON_ATTACK, player_node, context_attack)
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `apply_bleeding` —Ç–µ–ø–µ—Ä—å **–≤–Ω—É—Ç—Ä–∏** –±–ª–æ–∫–∞ `rat_bite`
2. ‚úÖ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π **–≤–Ω—É—Ç—Ä–∏** –±–ª–æ–∫–∞ `rat_bite`
3. ‚úÖ –ö–æ–¥ –±–æ–ª—å—à–µ **–Ω–µ –ø–∞–¥–∞–µ—Ç –≤ `else`** (—Å—Ç—Ä–æ–∫–∞ 1060)

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ö—Ä—ã—Å–∏–Ω—ã–π —É–∫—É—Å:
  –£—Ä–æ–Ω #1: 24 (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
  –£—Ä–æ–Ω #2: 24 (else –±–ª–æ–∫)
  –ò—Ç–æ–≥–æ: 48 —É—Ä–æ–Ω–∞ ‚ùå
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ö—Ä—ã—Å–∏–Ω—ã–π —É–∫—É—Å:
  –£—Ä–æ–Ω: 24 (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
  –ò—Ç–æ–≥–æ: 24 —É—Ä–æ–Ω–∞ ‚úÖ
```

**–£—Ä–æ–Ω —Å–Ω–∏–∂–µ–Ω –≤ 2 —Ä–∞–∑–∞!**

---

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –≤—Ä–∞–≥–∞:

```gdscript
if ability_used:
    if result.get("magic_arrow_volley", false):
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–µ–ª
    elif result.get("double_strike", false):
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤–æ–π–Ω–æ–≥–æ —É–¥–∞—Ä–∞
    elif result.get("rat_bite", false):
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞ ‚úÖ
        take_damage(damage)  # –£—Ä–æ–Ω –Ω–∞–Ω–æ—Å–∏—Ç—Å—è –∑–¥–µ—Å—å
        # –ö–æ–¥ –Ω–µ –∏–¥–µ—Ç –¥–∞–ª—å—à–µ!
    elif result.get("bat_swoop", false):
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∏–∫–∏—Ä–æ–≤–∞–Ω–∏—è
    ...
    else:
        # –û–±—ã—á–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–ù–ï —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è)
        take_damage(damage)  # –£—Ä–æ–Ω –¥–ª—è –æ–±—ã—á–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
```

**–¢–µ–ø–µ—Ä—å –ª–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è:**
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (`rat_bite`, `bat_swoop` –∏ —Ç.–¥.) –Ω–∞–Ω–æ—Å—è—Ç —É—Ä–æ–Ω –≤ —Å–≤–æ–∏—Ö –±–ª–æ–∫–∞—Ö
- –û–±—ã—á–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–∞–Ω–æ—Å—è—Ç —É—Ä–æ–Ω –≤ –±–ª–æ–∫–µ `else`
- –£—Ä–æ–Ω –Ω–∞–Ω–æ—Å–∏—Ç—Å—è **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**!

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª:**

`Scripts/Battle/battle_manager.gd`
- –°—Ç—Ä–æ–∫–∏ 881-896: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–ª–æ–∫–∞ `rat_bite`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `apply_bleeding` –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤–Ω—É—Ç—Ä—å –±–ª–æ–∫–∞
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤–Ω—É—Ç—Ä—å –±–ª–æ–∫–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. ‚úÖ –£—Ä–æ–Ω –æ—Ç –∫—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ~24, –Ω–µ ~48)
2. ‚úÖ –ù–∞–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è (50% —à–∞–Ω—Å)
3. ‚úÖ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –∫—Ä—ã—Å—ã
4. ‚úÖ –û–±—â–∏–π –±–∞–ª–∞–Ω—Å –±–æ—è —Å –∫—Ä—ã—Å–æ–π

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**–ö—Ä—ã—Å–∏–Ω—ã–π —É–∫—É—Å (—Å –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ–º):**
```
–ü—Ä—è–º–æ–π —É—Ä–æ–Ω: ~24
–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ: 3 —É—Ä–æ–Ω–∞/—Ö–æ–¥ √ó 3 —Ö–æ–¥–∞ = 9 —É—Ä–æ–Ω–∞
–ò—Ç–æ–≥–æ: ~33 —É—Ä–æ–Ω–∞ (–≤–º–µ—Å—Ç–æ 48 + 9 = 57)
```

**–ö—Ä—ã—Å–∏–Ω—ã–π —É–∫—É—Å (–±–µ–∑ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è):**
```
–ü—Ä—è–º–æ–π —É—Ä–æ–Ω: ~24
–ò—Ç–æ–≥–æ: ~24 —É—Ä–æ–Ω–∞ (–≤–º–µ—Å—Ç–æ 48)
```

---

## üí° –ò—Ç–æ–≥

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
‚úÖ –£–±—Ä–∞–Ω –¥–≤–æ–π–Ω–æ–π –≤—ã–∑–æ–≤ `take_damage` –¥–ª—è –∫—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞

### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `apply_bleeding` –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤–Ω—É—Ç—Ä—å –±–ª–æ–∫–∞ `rat_bite`  
‚úÖ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤–Ω—É—Ç—Ä—å –±–ª–æ–∫–∞ `rat_bite`  
‚úÖ –ö–æ–¥ –±–æ–ª—å—à–µ –Ω–µ –ø–∞–¥–∞–µ—Ç –≤ –±–ª–æ–∫ `else`  

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –£—Ä–æ–Ω –æ—Ç –∫—Ä—ã—Å–∏–Ω–æ–≥–æ —É–∫—É—Å–∞ —Å–Ω–∏–∂–µ–Ω –≤ 2 —Ä–∞–∑–∞ (—Å ~48 –¥–æ ~24)  
‚úÖ –ë–∞–ª–∞–Ω—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω  
‚úÖ –ö—Ä—ã—Å–∞ —Ç–µ–ø–µ—Ä—å –Ω–∞–Ω–æ—Å–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —É—Ä–æ–Ω  

---

## üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –∫—Ä—ã—Å—ã

–° —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

**–ö—Ä—ã—Å–∏–Ω—ã–π —É–∫—É—Å:**
```
–§–æ—Ä–º—É–ª–∞: —Å–∏–ª–∞ + –ª–æ–≤–∫–æ—Å—Ç—å * 1.5
–£—Ä–æ–Ω: ~24 (–¥–ª—è –∫—Ä—ã—Å—ã 2 —É—Ä–æ–≤–Ω—è)
–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ: 50% —à–∞–Ω—Å, 3 —É—Ä–æ–Ω–∞/—Ö–æ–¥ √ó 3 —Ö–æ–¥–∞ = 9 —É—Ä–æ–Ω–∞
–ö—É–ª–¥–∞—É–Ω: 2 (–∫–∞–∂–¥—ã–µ 2 —Ö–æ–¥–∞)

–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–Ω: 24 + (9 √ó 0.5) = 28.5 —É—Ä–æ–Ω–∞
–û–±—â–∏–π —É—Ä–æ–Ω: ~33 —É—Ä–æ–Ω–∞ (–µ—Å–ª–∏ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ –Ω–∞–ª–æ–∂–µ–Ω–æ)
```

**–í—ã–≤–æ–¥:** –ö—Ä—ã—Å–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –æ–ø–∞—Å–Ω–æ–π, –Ω–æ —Ç–µ–ø–µ—Ä—å —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π! ‚úÖ

