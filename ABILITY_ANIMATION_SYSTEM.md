# Система анимаций для способностей врагов

## Описание

Система позволяет назначать специальные анимации для способностей врагов. Если анимация не задана, используется стандартная анимация атаки.

## Структура файлов

- `Scripts/Battle/AbilityAnimationData.gd` - Ресурс для хранения привязки способностей к анимациям
- `Scripts/Battle/AbilityAnimationManager.gd` - Менеджер для загрузки и использования анимаций
- `Data/AbilityAnimations.tres` - Файл ресурса, где указываются анимации для способностей

## Как добавить анимацию для способности

### Шаг 1: Добавьте анимацию в SpriteFrames врага

1. Откройте сцену врага (например, `Scenes/Battle/Enemy_Rat.tscn`)
2. Найдите узел `Visual` (AnimatedSprite2D)
3. В инспекторе найдите `Sprite Frames`
4. Добавьте новую анимацию (например, `rat_bite_anim`)
5. Назначьте спрайты для этой анимации

### Шаг 2: Укажите анимацию в ресурсе

1. Откройте файл `Data/AbilityAnimations.tres` в Godot
2. В инспекторе найдите секцию `Ability Animations`
3. Добавьте или измените запись:
   - **Key**: `rat_bite` (ID способности)
   - **Value**: `rat_bite_anim` (имя анимации в SpriteFrames)

### Пример для способности "Крысиный укус"

```
ability_animations = {
"rat_bite": "rat_bite_anim"
}
```

## Поддерживаемые способности

Система автоматически определяет следующие способности:
- `rat_bite` - Крысиный укус
- `poison_strike` - Ядовитый удар
- `crossbow_shot` - Выстрел из арбалета
- `slashing_strike` - Режущий удар
- `rending_claws` - Разрывающие когти
- `bat_swoop` - Бросок летучей мыши
- `rotten_blast` - Гнилостный взрыв
- `acid_blast` - Кислотный взрыв
- `dark_blast` - Темный взрыв
- `curse_blast` - Проклятый взрыв

## Как это работает

1. Когда враг использует способность, система проверяет, есть ли для неё специальная анимация
2. Если анимация найдена и существует в SpriteFrames врага, она проигрывается
3. Если анимация не найдена или отсутствует в SpriteFrames, используется стандартная анимация атаки (`attack`)

## Примечания

- Анимация проигрывается **ДО** проверки попадания
- После завершения анимации автоматически возвращается к `idle`
- Если анимация не найдена, выводится предупреждение в консоль и используется fallback

