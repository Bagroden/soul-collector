# –°–∏—Å—Ç–µ–º–∞ Z-Index —Å–ª–æ–µ–≤ UI

## üìã –û–±–∑–æ—Ä

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø–æ—Ä—è–¥–∫—É –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.

---

## üé® –ò–µ—Ä–∞—Ä—Ö–∏—è —Å–ª–æ–µ–≤ (—Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö)

### –°–ª–æ–π 0: –§–æ–Ω
**Z-Index:** 0 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)  
**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- –§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (`Background`)
- –û–≤–µ—Ä–ª–µ–π –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è (`Overlay`)

### –°–ª–æ–π 10: –ê–Ω–∏–º–∞—Ü–∏–∏ —Ñ–æ–Ω–∞
**Z-Index:** 10  
**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- üå™Ô∏è **–í–∏—Ö—Ä—å –¥—É—à** (`SoulWellVortex`)
  - –ê–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü –¥—É—à –Ω–∞–¥ –∫–æ–ª–æ–¥—Ü–µ–º
  - –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è

### –°–ª–æ–π 15: NPC
**Z-Index:** 15  
**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- üóø **–°–∫—É–ª—å–ø—Ç–æ—Ä –¥—É—à** (`SoulSculptor`)
  - –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø—Ä–∞–π—Ç NPC
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
  - –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏

### –°–ª–æ–π 20+: –ë–∞–∑–æ–≤—ã–µ UI —ç–ª–µ–º–µ–Ω—Ç—ã
**Z-Index:** 20+ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Control —É–∑–ª–æ–≤)  
**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤–∞–ª—é—Ç
- –ó–∞–≥–æ–ª–æ–≤–∫–∏

### –°–ª–æ–π 100: –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
**Z-Index:** 100  
**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- üìã **PassiveAbilitiesWindow** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Å—Å–∏–≤–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏
- üìä **StatsScreen** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- üìö **AbilityLearningScreen** - –∏–∑—É—á–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
- üí¨ **SoulSculptorDialog** - –¥–∏–∞–ª–æ–≥ —Å NPC
- ‚ÑπÔ∏è **AcceptDialog** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### CharacterPreparation.gd

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**
```gdscript
func _initialize_soul_vortex():
    soul_vortex = Node2D.new()
    soul_vortex.set_script(soul_vortex_script)
    soul_vortex.z_index = 10  # –ü–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–∞ (UI –æ–∫–Ω–∞ –Ω–∞ z_index = 100)
    add_child(soul_vortex)

func _initialize_soul_sculptor():
    soul_sculptor = Node2D.new()
    soul_sculptor.set_script(sculptor_script)
    soul_sculptor.z_index = 15  # –ü–æ–≤–µ—Ä—Ö –≤–∏—Ö—Ä—è (UI –æ–∫–Ω–∞ –Ω–∞ z_index = 100)
    add_child(soul_sculptor)
```

**–°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω:**
```gdscript
# –û–∫–Ω–æ –ø–∞—Å—Å–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
func _show_passive_abilities_window():
    var passive_window = passive_window_scene.instantiate()
    passive_window.z_index = 100  # –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ (NPC –Ω–∞ 15, –≤–∏—Ö—Ä—å –Ω–∞ 10)
    add_child(passive_window)

# –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
func _on_distribute_stats_button_pressed():
    var stats_instance = stats_scene.instantiate()
    stats_instance.z_index = 100  # –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ (NPC –Ω–∞ 15, –≤–∏—Ö—Ä—å –Ω–∞ 10)
    add_child(stats_instance)

# –≠–∫—Ä–∞–Ω –∏–∑—É—á–µ–Ω–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
func _on_ability_learning_button_pressed():
    var ability_learning_instance = ability_learning_scene.instantiate()
    ability_learning_instance.z_index = 100  # –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ (NPC –Ω–∞ 15, –≤–∏—Ö—Ä—å –Ω–∞ 10)
    add_child(ability_learning_instance)

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
func _show_message(text: String):
    var dialog = AcceptDialog.new()
    dialog.z_index = 100  # –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ (NPC –Ω–∞ 15, –≤–∏—Ö—Ä—å –Ω–∞ 10)
    add_child(dialog)
```

### SoulSculptor.gd

**–î–∏–∞–ª–æ–≥ NPC:**
```gdscript
func _create_dialog():
    dialog = Control.new()
    dialog.set_script(dialog_script)
    dialog.z_index = 100  # –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ
    root.add_child(dialog)
```

---

## üìä –¢–∞–±–ª–∏—Ü–∞ Z-Index

| Z-Index | –°–ª–æ–π | –≠–ª–µ–º–µ–Ω—Ç—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------|----------|----------|
| 0 | –§–æ–Ω | Background, Overlay | –ó–∞–¥–Ω–∏–π –ø–ª–∞–Ω |
| 10 | –ê–Ω–∏–º–∞—Ü–∏–∏ | SoulWellVortex | –í–∏—Ö—Ä—å –¥—É—à –Ω–∞–¥ –∫–æ–ª–æ–¥—Ü–µ–º |
| 15 | NPC | SoulSculptor | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π NPC |
| 20+ | UI –±–∞–∑–æ–≤—ã–π | –ö–Ω–æ–ø–∫–∏, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã | –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
| 100 | –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ | –í—Å–µ –æ–∫–Ω–∞ –∏ –¥–∏–∞–ª–æ–≥–∏ | –ü–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ |

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Z-Index

### 1. –§–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (0-9)
- –°—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–æ–Ω—ã
- –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

### 2. –ê–Ω–∏–º–∞—Ü–∏–∏ —Ñ–æ–Ω–∞ (10-14)
- –ß–∞—Å—Ç–∏—Ü—ã
- –í–∏—Ö—Ä–∏
- –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- **–ù–µ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å UI**

### 3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ NPC (15-19)
- –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ —Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º
- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø—Ä–∞–π—Ç—ã
- **–ù–µ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–∞**

### 4. –ë–∞–∑–æ–≤—ã–π UI (20-99)
- –ö–Ω–æ–ø–∫–∏
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### 5. –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (100+)
- –í—Å–µ–≥–¥–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ
- –ë–ª–æ–∫–∏—Ä—É—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–æ–Ω–æ–º
- –¶–µ–Ω—Ç—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –û–∫–Ω–æ –ø–µ—Ä–µ–∫—Ä—ã—Ç–æ NPC/–≤–∏—Ö—Ä–µ–º

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π z_index —É –æ–∫–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
```gdscript
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
var window = window_scene.instantiate()
add_child(window)  # z_index = 0 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

# –ü–†–ê–í–ò–õ–¨–ù–û
var window = window_scene.instantiate()
window.z_index = 100  # –Ø–≤–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ–∫–∏–π z_index
add_child(window)
```

### –ü—Ä–æ–±–ª–µ–º–∞: NPC –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫–∏

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π z_index —É NPC

**–†–µ—à–µ–Ω–∏–µ:**
- NPC –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ z_index = 15
- –ö–Ω–æ–ø–∫–∏ –Ω–∞ z_index >= 20
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –Ω–∞ z_index = 100

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∏–∞–ª–æ–≥ –ø–æ–¥ –¥—Ä—É–≥–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

**–ü—Ä–∏—á–∏–Ω–∞:** –î–∏–∞–ª–æ–≥ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–µ –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É —É–∑–ª—É –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π z_index

**–†–µ—à–µ–Ω–∏–µ:**
```gdscript
# –î–æ–±–∞–≤–ª—è–µ–º –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É —É–∑–ª—É —Å –≤—ã—Å–æ–∫–∏–º z_index
var root = get_tree().current_scene
dialog.z_index = 100
root.add_child(dialog)
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ z_index

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
```gdscript
# –ü–æ–¥–Ω—è—Ç—å –æ–∫–Ω–æ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω
window.z_index = 100

# –û–ø—É—Å—Ç–∏—Ç—å –Ω–∞ –∑–∞–¥–Ω–∏–π –ø–ª–∞–Ω
window.z_index = 10

# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
element.move_to_front()  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π z_index —Å—Ä–µ–¥–∏ siblings
```

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –æ–∫–Ω–∞:
1. –°–æ–∑–¥–∞–π—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä: `var window = scene.instantiate()`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ z_index: `window.z_index = 100`
3. –î–æ–±–∞–≤—å—Ç–µ –≤ —Å—Ü–µ–Ω—É: `add_child(window)`

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –æ–∫–æ–Ω

- [ ] –û–∫–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `instantiate()`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `z_index = 100`
- [ ] z_index —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è **–î–û** –∏–ª–∏ **–°–†–ê–ó–£ –ü–û–°–õ–ï** `add_child()`
- [ ] –û–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–æ–¥–∏—Ç–µ–ª—é (–æ–±—ã—á–Ω–æ root)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å NPC –∏ –≤–∏—Ö—Ä–µ–º

---

## üéÆ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–ª–æ–µ–≤:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —ç–∫—Ä–∞–Ω –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–∏–¥–Ω—ã:
   - ‚úÖ –í–∏—Ö—Ä—å –¥—É—à (–∞–Ω–∏–º–∞—Ü–∏—è)
   - ‚úÖ –°–∫—É–ª—å–ø—Ç–æ—Ä –¥—É—à (NPC —Å–ø—Ä–∞–≤–∞)
3. –û—Ç–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - ‚úÖ –û–∫–Ω–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã–≤–∞–µ—Ç** –≤–∏—Ö—Ä—å –∏ NPC
   - ‚ùå –í–∏—Ö—Ä—å/NPC **–ù–ï** –≤–∏–¥–Ω—ã –ø–æ–≤–µ—Ä—Ö –æ–∫–Ω–∞
4. –ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
5. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–∏–∞–ª–æ–≥ —Å–æ –°–∫—É–ª—å–ø—Ç–æ—Ä–æ–º
   - ‚úÖ –î–∏–∞–ª–æ–≥ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã–≤–∞–µ—Ç** –≤–∏—Ö—Ä—å –∏ NPC
6. –û—Ç–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ –∏–∑—É—á–µ–Ω–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
   - ‚úÖ –û–∫–Ω–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã–≤–∞–µ—Ç** –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ–Ω–∞

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 20 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–§–∞–π–ª—ã:** `Scripts/UI/CharacterPreparation.gd`, `Scripts/NPC/SoulSculptor.gd`

